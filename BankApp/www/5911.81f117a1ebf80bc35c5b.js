(self.webpackChunkBankApp=self.webpackChunkBankApp||[]).push([[5911],{5911:(e,o,n)=>{"use strict";n.d(o,{g:()=>M});var t=n(1855),i=n(6637),r=n(3606),s=n(5401),a=n(7104),l=n(6274),c=n(4988),g=n(6603);function u(e,o){if(1&e&&r._UZ(0,"app-alert",4),2&e){const e=r.oxw(2);r.Q6J("message",e.message)("error",e.error)}}function d(e,o){if(1&e){const e=r.EpF();r.TgZ(0,"ion-card"),r.TgZ(1,"ion-card-header"),r.TgZ(2,"ion-card-title"),r._uU(3,"Selecciona una imagen"),r.qZA(),r.qZA(),r.YNc(4,u,1,2,"app-alert",1),r.TgZ(5,"ion-button",2),r.TgZ(6,"input",3),r.NdJ("change",function(o){return r.CHM(e),r.oxw().fileUpload(o.target)}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(4),r.Q6J("ngIf",e.error)}}function p(e,o){if(1&e){const e=r.EpF();r.TgZ(0,"ion-card"),r.TgZ(1,"ion-card-header"),r.TgZ(2,"ion-card-title"),r._uU(3," Imagen seleccionada "),r.qZA(),r.qZA(),r.TgZ(4,"ion-card"),r.TgZ(5,"ion-card-content"),r._UZ(6,"img",5),r.TgZ(7,"ion-button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw().guardarFoto()}),r._uU(8," Guardar "),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(6),r.Q6J("src",e.imgPath,r.LSH)}}let m=(()=>{class e{constructor(e,o){this.db=e,this.modalController=o,this.isImgUploaded=!1}ngOnInit(){}fileUpload(e){return(0,t.mG)(this,void 0,void 0,function*(){const o=e.files.item(0);if("image"!==o.type.split("/")[0])return this.error=!0,void(this.message="Tipo de archivo no soportado");if(o.size>4e5)return this.error=!0,void(this.message="La imagen debe ser menor a 200 kb");this.error=!1,this.fileName=o.name;const n=yield this.convertBase64(o);this.isImgUploaded=!0,this.imgPath=n})}convertBase64(e){return new Promise(o=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{o(n.result)}})}guardarFoto(){this.db.modifyImg(this.userName,"img",this.imgPath).then(e=>{}),this.modalController.dismiss()}}return e.\u0275fac=function(o){return new(o||e)(r.Y36(a.t),r.Y36(s.IN))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-upload-img"]],inputs:{userName:"userName"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"message","error",4,"ngIf"],["color","primary"],["type","file",1,"upload",3,"change"],[3,"message","error"],[3,"src"],["expand","block",3,"click"]],template:function(e,o){1&e&&(r.YNc(0,d,7,1,"ion-card",0),r.YNc(1,p,9,1,"ion-card",0)),2&e&&(r.Q6J("ngIf",!o.isImgUploaded),r.xp6(1),r.Q6J("ngIf",o.isImgUploaded))},directives:[l.O5,s.PM,s.Zi,s.gZ,s.YG,g.w,s.FN],styles:[""]}),e})();function Z(e,o){if(1&e){const e=r.EpF();r.TgZ(0,"ion-button",8),r.NdJ("click",function(){r.CHM(e);const o=r.oxw();return o.edit=!0,o.alert=!1}),r._UZ(1,"ion-icon",9),r.TgZ(2,"ion-label"),r._uU(3,"Cambiar contrase\xf1a"),r.qZA(),r.qZA()}}function f(e,o){if(1&e&&r._UZ(0,"app-alert",19),2&e){const e=r.oxw(2);r.Q6J("message",e.message)("error",e.error)}}function h(e,o){if(1&e){const e=r.EpF();r.TgZ(0,"ion-grid",10),r.TgZ(1,"h1"),r._uU(2,"Cambiar contrase\xf1a"),r.qZA(),r.TgZ(3,"ion-row"),r.TgZ(4,"ion-col",11),r.TgZ(5,"form",12,13),r.NdJ("ngSubmit",function(){r.CHM(e);const o=r.MAs(6);return r.oxw().cambiarPass(o)}),r.TgZ(7,"ion-item-group",14),r.YNc(8,f,1,2,"app-alert",15),r.TgZ(9,"ion-item"),r.TgZ(10,"ion-label",16),r._uU(11,"Password"),r.qZA(),r.TgZ(12,"ion-input",17),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw().password=o}),r.qZA(),r.qZA(),r.TgZ(13,"ion-item"),r.TgZ(14,"ion-label",16),r._uU(15,"Confirmar Password"),r.qZA(),r.TgZ(16,"ion-input",17),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw().confirmPassword=o}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(17,"ion-button",18),r._uU(18," Guardar "),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(6),o=r.oxw();r.xp6(8),r.Q6J("ngIf",o.alert),r.xp6(4),r.Q6J("ngModel",o.password),r.xp6(4),r.Q6J("ngModel",o.confirmPassword),r.xp6(1),r.Q6J("disabled",e.invalid)}}function x(e,o){if(1&e&&r._UZ(0,"img",33),2&e){const e=r.oxw(3);r.Q6J("src",e.user.img,r.LSH)}}function A(e,o){1&e&&r._UZ(0,"img",34)}function b(e,o){if(1&e&&r._UZ(0,"app-alert",19),2&e){const e=r.oxw(3);r.Q6J("message",e.message)("error",e.error)}}function q(e,o){if(1&e){const e=r.EpF();r.TgZ(0,"ion-row"),r.TgZ(1,"ion-col",21),r.TgZ(2,"ion-card",22),r.YNc(3,x,1,1,"img",23),r.YNc(4,A,1,0,"img",24),r.qZA(),r.TgZ(5,"ion-button",25),r.NdJ("click",function(){r.CHM(e);const o=r.oxw(2);return o.cambiarFoto=!0,o.alert=!1}),r._uU(6," Cambiar foto "),r.qZA(),r.qZA(),r.TgZ(7,"ion-col",26),r.TgZ(8,"form",12,27),r.NdJ("ngSubmit",function(){r.CHM(e);const o=r.MAs(9);return r.oxw(2).actualizarUser(o)}),r.TgZ(10,"ion-item-group"),r.YNc(11,b,1,2,"app-alert",15),r.TgZ(12,"ion-item"),r.TgZ(13,"ion-label",16),r._uU(14,"Usuario"),r.qZA(),r.TgZ(15,"ion-input",28),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw(2).user.usuario=o}),r.qZA(),r.qZA(),r.TgZ(16,"ion-item"),r.TgZ(17,"ion-label",16),r._uU(18,"Nombre"),r.qZA(),r.TgZ(19,"ion-input",29),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw(2).user.nombre=o}),r.qZA(),r.qZA(),r.TgZ(20,"ion-item"),r.TgZ(21,"ion-label",16),r._uU(22,"Direccion"),r.qZA(),r.TgZ(23,"ion-input",30),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw(2).user.direccion=o}),r.qZA(),r.qZA(),r.TgZ(24,"ion-item"),r.TgZ(25,"ion-label",16),r._uU(26,"Fecha de Nacimiento"),r.qZA(),r._UZ(27,"ion-input",31),r.qZA(),r.TgZ(28,"ion-item"),r.TgZ(29,"ion-label",16),r._uU(30,"Telefono"),r.qZA(),r.TgZ(31,"ion-input",32),r.NdJ("ngModelChange",function(o){return r.CHM(e),r.oxw(2).user.telefono=o}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(32,"ion-button",18),r._uU(33," Actualizar Datos "),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(9),o=r.oxw(2);r.xp6(3),r.Q6J("ngIf",o.user.img),r.xp6(1),r.Q6J("ngIf",!o.user.img),r.xp6(7),r.Q6J("ngIf",o.alert),r.xp6(4),r.Q6J("ngModel",o.user.usuario),r.xp6(4),r.Q6J("ngModel",o.user.nombre),r.xp6(4),r.Q6J("ngModel",o.user.direccion),r.xp6(4),r.Q6J("value",o.user.nacimiento),r.xp6(4),r.Q6J("ngModel",o.user.telefono),r.xp6(1),r.Q6J("disabled",e.invalid)}}function T(e,o){if(1&e&&(r.TgZ(0,"ion-row"),r._UZ(1,"app-upload-img",35),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("userName",e.user.usuario)}}function w(e,o){if(1&e&&(r.TgZ(0,"ion-grid",10),r.YNc(1,q,34,9,"ion-row",20),r.YNc(2,T,2,1,"ion-row",20),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.cambiarFoto),r.xp6(1),r.Q6J("ngIf",e.cambiarFoto)}}let M=(()=>{class e{constructor(e,o){this.modalController=e,this.db=o,this.edit=!1,this.alert=!1,this.error=!1,this.cambiarFoto=!1}ngOnInit(){this.imgPath=void 0===this.user.img?"../../../assets/images/profile-photo/empty.png":this.user.img}regresar(){this.modalController.dismiss(),this.alert=!1}cambiarPass(e){if(this.alert=!1,this.password===this.confirmPassword)if(this.password.length>4){const o=i.AES.encrypt(this.password,"secret key 123").toString();this.db.modifyPass(this.user.usuario,"password",o).then(e=>{e?(this.error=!1,this.alert=!0,this.message="Contrase\xf1a actualizada"):(this.error=!0,this.alert=!0,this.message="Error al actualizar")}),e.resetForm()}else this.error=!0,this.alert=!0,this.message="La contrase\xf1a es muy corta",e.resetForm();else this.error=!0,this.alert=!0,this.message="Las contrase\xf1as no coinciden",e.resetForm()}doRefresh(e){setTimeout(()=>(0,t.mG)(this,void 0,void 0,function*(){yield this.db.getUserData(this.user.usuario).then(e=>{this.user=e.data,this.alert=!1}),e.target.complete()}),1500)}actualizarUser(e){return(0,t.mG)(this,void 0,void 0,function*(){null!==this.user&&""!==this.user.rol&&null!==this.user.nacimiento?yield this.db.createUser(this.user).then(e=>{e?(this.error=!1,this.alert=!0,this.message="Informaci\xf3n actualizada"):(this.error=!0,this.alert=!0,this.message="Error al actualizar")}):(this.error=!0,this.alert=!0,this.message="Llena todos los campos")})}salirModal(){this.modalController.dismiss(),this.alert=!1}}return e.\u0275fac=function(o){return new(o||e)(r.Y36(s.IN),r.Y36(a.t))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-user-info"]],inputs:{user:"user"},decls:13,vars:3,consts:[[1,"flex"],["slot","start","color","primary",3,"click"],["slot","start","name","arrow-back-circle-outline"],["class","left","slot","end","color","warning",3,"click",4,"ngIf"],[1,"ion-padding"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Actualizar","refreshingSpinner","circles","refreshingText","Actualizando..."],["class","div-center","fixed","",4,"ngIf"],["slot","end","color","warning",1,"left",3,"click"],["slot","start","name","key-outline"],["fixed","",1,"div-center"],["size","12"],[3,"ngSubmit"],["form","ngForm"],["no-lines",""],[3,"message","error",4,"ngIf"],["position","floating"],["name","password","type","password","placeholder","Password","show-hide-input","","required","",3,"ngModel","ngModelChange"],["expand","block","color","primary","type","submit",1,"ion-margin",3,"disabled"],[3,"message","error"],[4,"ngIf"],["size","4"],[1,"poster"],[3,"src",4,"ngIf"],["src","../../../assets/images/profile-photo/empty.png",4,"ngIf"],["expand","block","fill","clear","shape","round",1,"button",3,"click"],["size","8"],["formulario","ngForm"],["disabled","true","maxlength","10","pattern","^([a-zA-Z0-9_\\-\\.]+)$","name","usuario","type","text","required","",3,"ngModel","ngModelChange"],["maxlength","25","pattern","^([a-zA-Z0-9_\\-\\.]+)$","name","nombre","type","text","required","",3,"ngModel","ngModelChange"],["maxlength","100","pattern","^([a-zA-Z0-9_\\-\\.]+)$","name","direccion","type","text","required","",3,"ngModel","ngModelChange"],["type","text","name","nacimiento","disabled","true",3,"value"],["maxlength","10","pattern","^([0-9_\\-\\.]+)$","name","telefono","type","text","required","",3,"ngModel","ngModelChange"],[3,"src"],["src","../../../assets/images/profile-photo/empty.png"],[3,"userName"]],template:function(e,o){1&e&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-buttons",0),r.TgZ(3,"ion-button",1),r.NdJ("click",function(){return o.regresar()}),r._UZ(4,"ion-icon",2),r.TgZ(5,"ion-label"),r._uU(6,"Regresar"),r.qZA(),r.qZA(),r.YNc(7,Z,4,0,"ion-button",3),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"ion-content",4),r.TgZ(9,"ion-refresher",5),r.NdJ("ionRefresh",function(e){return o.doRefresh(e)}),r._UZ(10,"ion-refresher-content",6),r.qZA(),r.YNc(11,h,19,4,"ion-grid",7),r.YNc(12,w,3,2,"ion-grid",7),r.qZA()),2&e&&(r.xp6(7),r.Q6J("ngIf",!o.edit),r.xp6(4),r.Q6J("ngIf",o.edit),r.xp6(1),r.Q6J("ngIf",!o.edit))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.gu,s.Q$,l.O5,s.W2,s.nJ,s.Wo,s.jY,s.Nd,s.wI,c._Y,c.JL,c.F,s.Ub,s.Ie,s.pK,s.j9,c.Q7,c.JJ,c.On,g.w,s.PM,c.nD,c.c5,m],styles:[".poster-detalle-sobre[_ngcontent-%COMP%]{position:relative;top:-75px;left:-10px;margin-bottom:-75px}.titulo[_ngcontent-%COMP%]{width:100%;position:absolute;color:#fff;background-color:red;padding:5px 5px 40px;background:linear-gradient(180deg,#000000a6 0,#0000)}.flex[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-content:space-between}.titulo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{position:absolute;top:28px;left:5px}ion-label[_ngcontent-%COMP%]{white-space:normal!important}.button[_ngcontent-%COMP%]{white-space:pre-wrap!important;height:min(2fr,1fr)}"]}),e})()}}]);